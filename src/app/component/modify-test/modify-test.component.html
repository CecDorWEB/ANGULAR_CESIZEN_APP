<section class="Add_question">
  <!-- Ajouter une question -->
  <button (click)="showAddQuestion()">+ Ajouter une question</button>

  <!--Formulaire d'ajout d'une Question-->
  <section *ngIf="AddQuestion && type === 'test'">
    <form #form="ngForm" (ngSubmit)="onSubmitNewQuestion()" novalidate>
      <p>Veuillez remplir les champs ci-dessous:</p>
      <label for="question">Question:</label>
      <textarea
        name="question"
        [(ngModel)]="newQuestion.question"
        [ngModelOptions]="{ standalone: true }"
        #question="ngModel"
        required
        rows="2"
      ></textarea>
      <div *ngIf="question.invalid && question.touched">
        <span *ngIf="question.errors?.['required']">Question requise</span>
      </div>
      <label for="rule">Consigne de réponse:</label>
      <textarea
        name="rule"
        [(ngModel)]="newQuestion.rule"
        [ngModelOptions]="{ standalone: true }"
        #rule="ngModel"
      ></textarea>
      <label for="number_expected_answers"
        >Nombre de réponse attendue (ne rien mettre si illimité):</label
      >
      <input
        type="number"
        name="number_expected_answers"
        [(ngModel)]="newQuestion.number_expected_answers"
        [ngModelOptions]="{ standalone: true }"
        #number_expected_answers="ngModel"
      />
      <input
        type="submit"
        value="Ajouter la question"
        [disabled]="form.invalid"
      />
      <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>
    </form>
  </section>
  <!--Affichage des questions -->
  <section class="view_question border" *ngFor="let question of questionList">
    <div
      class="display_mode_container"
      *ngIf="!question.isEditing; else editQuestionMode"
    >
      <div class="question">
        <app-display-question [question]="question"></app-display-question>
        <button class="secondary_button">+ Ajouter une réponse</button>
      </div>
      <article class="question_admin_tools">
        <button (click)="toggleQuestionEdit(question)">Modifier</button>
        <button class="delete" (click)="deleteQuestion(question.id)">
          Supprimer
        </button>
      </article>
    </div>
    <!--Mode édition d'une question-->
    <ng-template #editQuestionMode>
      <form
        class="form_question_mode"
        #form="ngForm"
        (ngSubmit)="updateQuestion()"
        novalidate
      >
        <p>Veuillez modifier les champs ci-dessous:</p>
        <label for="question">Question:</label>
        <textarea
          name="question"
          [(ngModel)]="question.question"
          [ngModelOptions]="{ standalone: true }"
          #questionCtrl="ngModel"
          required
          rows="2"
        ></textarea>
        <div *ngIf="questionCtrl.invalid && questionCtrl.touched">
          <span *ngIf="questionCtrl.errors?.['required']"
            >Question requise</span
          >
        </div>
        <label for="rule">Consigne de réponse:</label>
        <textarea
          name="rule"
          [(ngModel)]="question.rule"
          [ngModelOptions]="{ standalone: true }"
          #ruleCtrl="ngModel"
        ></textarea>
        <label for="number_expected_answers"
          >Nombre de réponse attendue (ne rien mettre si illimité):</label
        >
        <input
          type="number"
          name="number_expected_answers"
          [(ngModel)]="question.number_expected_answers"
          [ngModelOptions]="{ standalone: true }"
          #number_expected_answersCtrl="ngModel"
        />
        <button
          (click)="setQuestionToEdit(question)"
          type="submit"
          value="Modifier la question"
          [disabled]="form.invalid"
        >
          Modifier
        </button>
        <button type="button" (click)="toggleQuestionEdit(null)">
          Annuler
        </button>
        <p *ngIf="errorMessage" class="error">{{ errorMessage }}</p>
      </form>
    </ng-template>
  </section>
</section>
